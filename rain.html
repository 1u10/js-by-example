<!DOCTYPE html>
<html>
    <head>

    </head>
    <body>
        <canvas id="rain-canvas" width="800" height="800">
        </canvas>
        <script type="text/javascript">

            m = document.getElementById("rain-canvas").getContext("2d")

            var drop = (x, y, color, size) => { m.fillStyle=color; m.fillRect(x,y, size.width ,size.height);}

            let drops = [];
            let windowSize = 800;
            let floorPosition = 700;

            var randomNumber = (max) => Math.floor(Math.random() * max);
            var randomNumberBetween = (start, end) => (Math.floor(Math.random() * (end - start) + start));

            var cleanCanvas = () => {
                m.fillStyle = "white";
                m.fillRect(0, 0, windowSize, windowSize);
            }

            var init = () => {

                for (var i = 0; i < 2000; i++) {
                    var x = randomNumber(1000);
                    var y = randomNumber(-1000);
                    var color ="rgba(0,0," + randomNumberBetween(100, 256) + ","+ (Math.random() * (0.9 - 0.1) + 0.1).toFixed(2) +")";
                    var size = { width: 1, height: randomNumber(25) };
                    drops.push({x, y, color, size});
                }

                rain();
            }

            var rain = () => {

                cleanCanvas();
                
                for (var index = 0; index < drops.length; index++) {

                    var d = drops[index];

                    drop(d.x, d.y, d.color, d.size);

                    d.x = d.x 

                    d.y = d.y + randomNumber(70); // esto no deberia estar aca 

                    if( d.y > windowSize ) {
                        d.y = randomNumber(-1000);
                        d.x = randomNumber(1000);
                        d.size.width = 1;
                        d.size.height = randomNumber(25);
                    }

                    if( d.y > floorPosition ) {
                        d.size.width = d.size.height;
                        d.size.height = 1;
                    }
                }

                setTimeout(rain,100);
            }

            init();

        </script>
    </body>
</html>